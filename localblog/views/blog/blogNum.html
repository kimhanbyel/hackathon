{% extends "index.html" %}

{% block mid %}
    <div class="m-20 space-y-12">
        <div class="border-b border-gray-900/10 pb-12">
            <div class="flex justify-center">
                {% if info.img %}
                <img class="h-40 w-40 rounded-full bg-gray-50" src="/static/{{info.img}}">
                {% else %}
                <img class="h-40 w-40 rounded-full bg-gray-50" src="/static/basicUserImg.png">
                {% endif %}
            </div>
            <div>
                <h2 class="mt-6 text-center text-3xl font-semibold leading-7 text-gray-900">{{info.nick}}</h2>
                {% if info.about %}
                    <p class="mt-1 text-center text-sm leading-6 text-gray-600">{{info.about}}</p>
                {% else %}
                    <p class="mt-1 text-center text-sm leading-6 text-gray-600">( ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤ )</p>
                {% endif %}
                <p class="mt-1 text-center text-sm leading-6 text-gray-600">ë§ˆì§€ë§‰ ì ‘ì†ì¼ : {{info.lastLogin}}</p>
                {% if info.id == user.id %}
                <div class="flex justify-center">
                    <button class="w-50 rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600" onclick="location.href='/myPage/{{user.id}}/edit'">ìˆ˜ì •</button>
                </div>
                {% endif %}
            </div>
            <div class="mt-5 border-b border-gray-900/10 text-center">ìµœì‹  ê¸€</div>
            <div class="flex flex-col items-center">
                {% if posts.length >= 1 %}
                    {% set postCnt = 0 %}
                    {% for post in posts %}
                        {% set postCnt = postCnt + 1 %}
                        {% if postCnt <= 3 %}
                            <a href="/blog/post/{{post.idposts}}">
                                <li class="flex justify-between gap-x-6 pt-10">
                                    <div class="flex gap-x-4">
                                        {% if post.img %}
                                            <img class="h-12 w-12 flex-none rounded-full bg-gray-50" src="/static/{{post.img}}" alt="">
                                        {% else %}
                                            <img class="h-12 w-12 flex-none rounded-full bg-gray-50" src="/static/basicPostImg.png" alt="">
                                        {% endif %}
                                        <div class="min-w-0 flex-auto">
                                            <p style="text-overflow: ellipsis" class="w-96 text-xl font-semibold leading-6 text-gray-900">{{post.title}}</p>
                                            <p style="text-overflow: ellipsis" class="w-96 mt-1 truncate text-m leading-5 text-gray-500">{{post.content}}</p>
                                        </div>
                                    </div>
                                    <div class="hidden sm:flex sm:flex-col sm:items-end">
                                        <p class="w-20 text-sm leading-5 text-gray-500">ğŸ’¬{{post.commentCnt}}</p>
                                        <p class="w-20 text-sm leading-5 text-gray-500">ğŸ‘{{post.views}}</p>
                                        <p class="w-20 mt-1 text-s leading-5 text-gray-900">{{post.writer}}</p>
                                    </div>
                                </li>
                            </a>
                            <div class="bg-gray-700 w-auto h-0"></div>
                            {% if postCnt == 3 %}
                                <button onclick="location.href='/blog/blog_list/{{params}}/post'" class="w-50 mt-10 rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-offset-2 focus-visible:outline-indigo-600">ì „ì²´ê¸€ ì½ì–´ë³´ê¸°</button>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <p class="mt-3 text-center text-sm text-gray-600">( ê¸€ì´ ì—†ìŠµë‹ˆë‹¤ )</p>
                {% endif %}
                {% if user.nick == info.nick %}
                    <button onclick="location.href='/blog/post_registration'" class="w-50 mt-2 rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-offset-2 focus-visible:outline-indigo-600">ê¸€ ì“°ê¸°</button>
                {% endif %}
            </div>
            <div class="mt-5 border-b border-gray-900/10 text-center">í”Œë ˆì´ë¦¬ìŠ¤íŠ¸</div>
            <div class="flex flex-col items-center">
                {% if playlists %}
                    <div id="slideShow">
                        <ul class="slides">
                            {% for playlist in playlists %}
                                <a href="/playlist/{{playlist.idplaylist}}">
                                <li class="flex flex-col py-5">
                                    {% if playlist.img %}
                                        <img class="h-40 w-40 rounded-full bg-gray-50" src="/static/{{playlist.img}}">
                                    {% else %}
                                        <img class="h-40 w-40 rounded-full bg-gray-50" src="/static/basicMusicImg.png">
                                    {% endif %}
                                    <div class="flex justify-center">
                                        <div class="min-w-2 flex-auto">
                                        <p class="w-40 text-xl font-semibold leading-5 text-gray-900">{{playlist.title}}</p>
                                        <p class="w-40 mt-1 truncate text-m leading-5 text-gray-500">{{playlist.maker}}</p>
                                        <p class="w-40 mt-1 truncate text-m leading-5 text-gray-500">{{playlist.count}}ê°œ</p>
                                        <div>
                                            <p class="text-base text-gray-900 mt-20">ğŸ‘ {{playlist.views}}</p>
                                        </div>
                                        </div>
                                    </div>
                                </li>
                                </a>
                            {% endfor %}
                        </ul>
                        <p class="controller">
                            <!-- &lang: ì™¼ìª½ ë°©í–¥ í™”ì‚´í‘œ
                            &rang: ì˜¤ë¥¸ìª½ ë°©í–¥ í™”ì‚´í‘œ -->
                            <span class="prev mr-10 text-red-500">&lang;</span>  
                            <span class="next ml-10 text-red-500">&rang;</span>
                        </p>
                    </div>
                {% else %}
                    <p class="mt-1 text-center text-sm leading-6 text-gray-600">( í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤ )</p>
                {% endif %}
            </div>
        </div>
    </div>

    <style>
        li{
          list-style-type: none;
        }
      
        #slideShow{
          width: 900px;
          height: 450px;
          position: relative;
          margin: 50px auto;
          overflow: hidden;   
          /*ë¦¬ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì¼ë ¬ë¡œ 
          ì •ë ¬í•  ê²ƒì´ê¸° ë•Œë¬¸ì—, 400px ë°–ìœ¼ë¡œ íŠ€ì–´ ë‚˜ê°„ ì´ë¯¸ì§€ë“¤ì€
          hiddenìœ¼ë¡œ ìˆ¨ê²¨ì¤˜ì•¼ë¨*/
        }
      
      
        .slides{
          position: absolute;
          left: 0;
          top: 0;
          width: 2500px; /* ìŠ¬ë¼ì´ë“œí•  ì‚¬ì§„ê³¼ ë§ˆì§„ ì´ ë„“ì´ */
          transition: left 0.5s ease-out; 
          /*ease-out: ì²˜ìŒì—ëŠ” ëŠë ¸ë‹¤ê°€ ì ì  ë¹¨ë¼ì§*/
        }
      
        /* ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ ê°€ìš´ë°ì— ì •ë ¬í•˜ê¸°ìœ„í•´
        ì²«ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë§Œ margin-leftì¡°ì • */
        .slides li:first-child{
          margin-left: 120px;
        }
      
        /* ìŠ¬ë¼ì´ë“œë“¤ ì˜†ìœ¼ë¡œ ì •ë ¬ */
        .slides li:not(:last-child){
          float: left;
          margin-right: 30px;
        }
      
        .slides li{
          float: left;
        }
      
        .controller span{
          position:absolute;
          background-color: transparent;
          color: black;
          text-align: center;
          border-radius: 50%;
          padding: 10px 20px;
          top: 50%;
          font-size: 1.3em;
          cursor: pointer;
        }
      
        /* ì´ì „, ë‹¤ìŒ í™”ì‚´í‘œì— ë§ˆìš°ìŠ¤ ì»¤ì„œê°€ ì˜¬ë¼ê°€ ìˆì„ë•Œ */
        .controller span:hover{
          background-color: rgba(128, 128, 128, 0.11);
        }
      
        .prev{
          left: 10px;
        }
      
        /* ì´ì „ í™”ì‚´í‘œì— ë§ˆìš°ìŠ¤ ì»¤ì„œê°€ ì˜¬ë¼ê°€ ìˆì„ë•Œ 
        ì´ì „ í™”ì‚´í‘œê°€ ì‚´ì§ ì™¼ìª½ìœ¼ë¡œ ì´ë™í•˜ëŠ” íš¨ê³¼*/
        .prev:hover{
          transform: translateX(-10px);
        }
      
        .next{
          right: 10px;
        }
      
        /* ë‹¤ìŒ í™”ì‚´í‘œì— ë§ˆìš°ìŠ¤ ì»¤ì„œê°€ ì˜¬ë¼ê°€ ìˆì„ë•Œ 
        ì´ì „ í™”ì‚´í‘œê°€ ì‚´ì§ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™í•˜ëŠ” íš¨ê³¼*/
        .next:hover{
          transform: translateX(10px);
      }
    </style>

    <script>
        document.title = "{{info.nick}}ì˜ ë¸”ë¡œê·¸"

        const slides = document.querySelector('.slides'); //ì „ì²´ ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ
        const slideImg = document.querySelectorAll('.slides li'); //ëª¨ë“  ìŠ¬ë¼ì´ë“œë“¤
        let currentIdx = 0; //í˜„ì¬ ìŠ¬ë¼ì´ë“œ index
        const slideCount = slideImg.length; // ìŠ¬ë¼ì´ë“œ ê°œìˆ˜
        const prev = document.querySelector('.prev'); //ì´ì „ ë²„íŠ¼
        const next = document.querySelector('.next'); //ë‹¤ìŒ ë²„íŠ¼
        const slideWidth = 500; //í•œê°œì˜ ìŠ¬ë¼ì´ë“œ ë„“ì´
        const slideMargin = 100; //ìŠ¬ë¼ì´ë“œê°„ì˜ margin ê°’

        //ì „ì²´ ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ ë„“ì´ ì„¤ì •
        slides.style.width = (slideWidth + slideMargin) * slideCount + 'px';

        function moveSlide(num) {
            slides.style.left = -num * 350 + 'px';
            currentIdx = num;
        }

        prev.addEventListener('click', function () {
            /*ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë¡œ í‘œì‹œ ëì„ë•ŒëŠ” 
            ì´ì „ ë²„íŠ¼ ëˆŒëŸ¬ë„ ì•„ë¬´ëŸ° ë°˜ì‘ ì—†ê²Œ í•˜ê¸° ìœ„í•´ 
            currentIdx !==0ì¼ë•Œë§Œ moveSlide í•¨ìˆ˜ ë¶ˆëŸ¬ì˜´ */

            if (currentIdx !== 0) moveSlide(currentIdx - 1);
        });

        next.addEventListener('click', function () {
            /* ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œë¡œ í‘œì‹œ ëì„ë•ŒëŠ” 
            ë‹¤ìŒ ë²„íŠ¼ ëˆŒëŸ¬ë„ ì•„ë¬´ëŸ° ë°˜ì‘ ì—†ê²Œ í•˜ê¸° ìœ„í•´
            currentIdx !==slideCount - 1 ì¼ë•Œë§Œ 
            moveSlide í•¨ìˆ˜ ë¶ˆëŸ¬ì˜´ */
            if (currentIdx !== slideCount - 1) {
            moveSlide(currentIdx + 1);
            }
        });
    </script>
{% endblock %}